import{h as Q,b as Ne,d as J,e as F,f as ce,g as ae,i as De,j as ze,k as Be,l as $e,m as V,u as Re,n as He,p as Me,t as Ke,q as We,s as Ge,v as ve,w as Je,x as we,y as Ae,z as Ve,A as Ye,N as Qe,B as Ze,C as Xe,D as ke,E as ue,G as et,H as Ie,I as tt,J as st,o as Se,K as Te,L as te,M as K,O as G,P as ge,Q as nt,R as it,S as le,T as fe,U as ot,c as rt,r as at,V as lt,F as ct,W as dt,X as x,Y as C}from"./index-aMjRQuCd.js";const ut=Q("svg",{viewBox:"0 0 64 64",class:"check-icon"},Q("path",{d:"M50.42,16.76L22.34,39.45l-8.1-11.46c-1.12-1.58-3.3-1.96-4.88-0.84c-1.58,1.12-1.95,3.3-0.84,4.88l10.26,14.51  c0.56,0.79,1.42,1.31,2.38,1.45c0.16,0.02,0.32,0.03,0.48,0.03c0.8,0,1.57-0.27,2.2-0.78l30.99-25.03c1.5-1.21,1.74-3.42,0.52-4.92  C54.13,15.78,51.93,15.55,50.42,16.76z"})),ht=Q("svg",{viewBox:"0 0 100 100",class:"line-icon"},Q("path",{d:"M80.2,55.5H21.4c-2.8,0-5.1-2.5-5.1-5.5l0,0c0-3,2.3-5.5,5.1-5.5h58.7c2.8,0,5.1,2.5,5.1,5.5l0,0C85.2,53.1,82.9,55.5,80.2,55.5z"})),pt=Ne("n-checkbox-group"),mt=J([F("checkbox",`
 font-size: var(--n-font-size);
 outline: none;
 cursor: pointer;
 display: inline-flex;
 flex-wrap: nowrap;
 align-items: flex-start;
 word-break: break-word;
 line-height: var(--n-size);
 --n-merged-color-table: var(--n-color-table);
 `,[ce("show-label","line-height: var(--n-label-line-height);"),J("&:hover",[F("checkbox-box",[ae("border","border: var(--n-border-checked);")])]),J("&:focus:not(:active)",[F("checkbox-box",[ae("border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),ce("inside-table",[F("checkbox-box",`
 background-color: var(--n-merged-color-table);
 `)]),ce("checked",[F("checkbox-box",`
 background-color: var(--n-color-checked);
 `,[F("checkbox-icon",[J(".check-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),ce("indeterminate",[F("checkbox-box",[F("checkbox-icon",[J(".check-icon",`
 opacity: 0;
 transform: scale(.5);
 `),J(".line-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),ce("checked, indeterminate",[J("&:focus:not(:active)",[F("checkbox-box",[ae("border",`
 border: var(--n-border-checked);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),F("checkbox-box",`
 background-color: var(--n-color-checked);
 border-left: 0;
 border-top: 0;
 `,[ae("border",{border:"var(--n-border-checked)"})])]),ce("disabled",{cursor:"not-allowed"},[ce("checked",[F("checkbox-box",`
 background-color: var(--n-color-disabled-checked);
 `,[ae("border",{border:"var(--n-border-disabled-checked)"}),F("checkbox-icon",[J(".check-icon, .line-icon",{fill:"var(--n-check-mark-color-disabled-checked)"})])])]),F("checkbox-box",`
 background-color: var(--n-color-disabled);
 `,[ae("border",`
 border: var(--n-border-disabled);
 `),F("checkbox-icon",[J(".check-icon, .line-icon",`
 fill: var(--n-check-mark-color-disabled);
 `)])]),ae("label",`
 color: var(--n-text-color-disabled);
 `)]),F("checkbox-box-wrapper",`
 position: relative;
 width: var(--n-size);
 flex-shrink: 0;
 flex-grow: 0;
 user-select: none;
 -webkit-user-select: none;
 `),F("checkbox-box",`
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 height: var(--n-size);
 width: var(--n-size);
 display: inline-block;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color 0.3s var(--n-bezier);
 `,[ae("border",`
 transition:
 border-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border: var(--n-border);
 `),F("checkbox-icon",`
 display: flex;
 align-items: center;
 justify-content: center;
 position: absolute;
 left: 1px;
 right: 1px;
 top: 1px;
 bottom: 1px;
 `,[J(".check-icon, .line-icon",`
 width: 100%;
 fill: var(--n-check-mark-color);
 opacity: 0;
 transform: scale(0.5);
 transform-origin: center;
 transition:
 fill 0.3s var(--n-bezier),
 transform 0.3s var(--n-bezier),
 opacity 0.3s var(--n-bezier),
 border-color 0.3s var(--n-bezier);
 `),De({left:"1px",top:"1px"})])]),ae("label",`
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 padding: var(--n-label-padding);
 font-weight: var(--n-label-font-weight);
 `,[J("&:empty",{display:"none"})])]),ze(F("checkbox",`
 --n-merged-color-table: var(--n-color-table-modal);
 `)),Be(F("checkbox",`
 --n-merged-color-table: var(--n-color-table-popover);
 `))]),ft=Object.assign(Object.assign({},ve.props),{size:String,checked:{type:[Boolean,String,Number],default:void 0},defaultChecked:{type:[Boolean,String,Number],default:!1},value:[String,Number],disabled:{type:Boolean,default:void 0},indeterminate:Boolean,label:String,focusable:{type:Boolean,default:!0},checkedValue:{type:[Boolean,String,Number],default:!0},uncheckedValue:{type:[Boolean,String,Number],default:!1},"onUpdate:checked":[Function,Array],onUpdateChecked:[Function,Array],privateInsideTable:Boolean,onChange:[Function,Array]}),Ce=$e({name:"Checkbox",props:ft,setup(a){const t=V(null),{mergedClsPrefixRef:e,inlineThemeDisabled:s,mergedRtlRef:n}=Re(a),i=He(a,{mergedSize(O){const{size:ee}=a;if(ee!==void 0)return ee;if(m){const{value:W}=m.mergedSizeRef;if(W!==void 0)return W}if(O){const{mergedSize:W}=O;if(W!==void 0)return W.value}return"medium"},mergedDisabled(O){const{disabled:ee}=a;if(ee!==void 0)return ee;if(m){if(m.disabledRef.value)return!0;const{maxRef:{value:W},checkedCountRef:se}=m;if(W!==void 0&&se.value>=W&&!B.value)return!0;const{minRef:{value:U}}=m;if(U!==void 0&&se.value<=U&&B.value)return!0}return O?O.disabled.value:!1}}),{mergedDisabledRef:o,mergedSizeRef:d}=i,m=Me(pt,null),g=V(a.defaultChecked),E=Ke(a,"checked"),T=We(E,g),B=Ge(()=>{if(m){const O=m.valueSetRef.value;return O&&a.value!==void 0?O.has(a.value):!1}else return T.value===a.checkedValue}),D=ve("Checkbox","-checkbox",mt,Xe,a,e);function c(O){if(m&&a.value!==void 0)m.toggleCheckbox(!B.value,a.value);else{const{onChange:ee,"onUpdate:checked":W,onUpdateChecked:se}=a,{nTriggerFormInput:U,nTriggerFormChange:I}=i,p=B.value?a.uncheckedValue:a.checkedValue;W&&ke(W,p,O),se&&ke(se,p,O),ee&&ke(ee,p,O),U(),I(),g.value=p}}function H(O){o.value||c(O)}function L(O){if(!o.value)switch(O.key){case" ":case"Enter":c(O)}}function R(O){switch(O.key){case" ":O.preventDefault()}}const me={focus:()=>{var O;(O=t.value)===null||O===void 0||O.focus()},blur:()=>{var O;(O=t.value)===null||O===void 0||O.blur()}},oe=Je("Checkbox",n,e),re=we(()=>{const{value:O}=d,{common:{cubicBezierEaseInOut:ee},self:{borderRadius:W,color:se,colorChecked:U,colorDisabled:I,colorTableHeader:p,colorTableHeaderModal:l,colorTableHeaderPopover:r,checkMarkColor:b,checkMarkColorDisabled:y,border:$,borderFocus:h,borderDisabled:P,borderChecked:S,boxShadowFocus:w,textColor:_,textColorDisabled:f,checkMarkColorDisabledChecked:k,colorDisabledChecked:u,borderDisabledChecked:v,labelPadding:j,labelLineHeight:A,labelFontWeight:q,[ue("fontSize",O)]:M,[ue("size",O)]:z}}=D.value;return{"--n-label-line-height":A,"--n-label-font-weight":q,"--n-size":z,"--n-bezier":ee,"--n-border-radius":W,"--n-border":$,"--n-border-checked":S,"--n-border-focus":h,"--n-border-disabled":P,"--n-border-disabled-checked":v,"--n-box-shadow-focus":w,"--n-color":se,"--n-color-checked":U,"--n-color-table":p,"--n-color-table-modal":l,"--n-color-table-popover":r,"--n-color-disabled":I,"--n-color-disabled-checked":u,"--n-text-color":_,"--n-text-color-disabled":f,"--n-check-mark-color":b,"--n-check-mark-color-disabled":y,"--n-check-mark-color-disabled-checked":k,"--n-font-size":M,"--n-label-padding":j}}),X=s?Ae("checkbox",we(()=>d.value[0]),re,a):void 0;return Object.assign(i,me,{rtlEnabled:oe,selfRef:t,mergedClsPrefix:e,mergedDisabled:o,renderedChecked:B,mergedTheme:D,labelId:Ve(),handleClick:H,handleKeyUp:L,handleKeyDown:R,cssVars:s?void 0:re,themeClass:X==null?void 0:X.themeClass,onRender:X==null?void 0:X.onRender})},render(){var a;const{$slots:t,renderedChecked:e,mergedDisabled:s,indeterminate:n,privateInsideTable:i,cssVars:o,labelId:d,label:m,mergedClsPrefix:g,focusable:E,handleKeyUp:T,handleKeyDown:B,handleClick:D}=this;(a=this.onRender)===null||a===void 0||a.call(this);const c=Ye(t.default,H=>m||H?Q("span",{class:`${g}-checkbox__label`,id:d},m||H):null);return Q("div",{ref:"selfRef",class:[`${g}-checkbox`,this.themeClass,this.rtlEnabled&&`${g}-checkbox--rtl`,e&&`${g}-checkbox--checked`,s&&`${g}-checkbox--disabled`,n&&`${g}-checkbox--indeterminate`,i&&`${g}-checkbox--inside-table`,c&&`${g}-checkbox--show-label`],tabindex:s||!E?void 0:0,role:"checkbox","aria-checked":n?"mixed":e,"aria-labelledby":d,style:o,onKeyup:T,onKeydown:B,onClick:D,onMousedown:()=>{Ze("selectstart",window,H=>{H.preventDefault()},{once:!0})}},Q("div",{class:`${g}-checkbox-box-wrapper`},"Â ",Q("div",{class:`${g}-checkbox-box`},Q(Qe,null,{default:()=>this.indeterminate?Q("div",{key:"indeterminate",class:`${g}-checkbox-icon`},ht):Q("div",{key:"check",class:`${g}-checkbox-icon`},ut)}),Q("div",{class:`${g}-checkbox-box__border`}))),c)}}),gt=F("h",`
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 margin: var(--n-margin);
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[J("&:first-child",{marginTop:0}),ce("prefix-bar",{position:"relative",paddingLeft:"var(--n-prefix-width)"},[ce("align-text",{paddingLeft:0},[J("&::before",{left:"calc(-1 * var(--n-prefix-width))"})]),J("&::before",`
 content: "";
 width: var(--n-bar-width);
 border-radius: calc(var(--n-bar-width) / 2);
 transition: background-color .3s var(--n-bezier);
 left: 0;
 top: 0;
 bottom: 0;
 position: absolute;
 `),J("&::before",{backgroundColor:"var(--n-bar-color)"})])]),bt=Object.assign(Object.assign({},ve.props),{type:{type:String,default:"default"},prefix:String,alignText:Boolean}),yt=a=>$e({name:`H${a}`,props:bt,setup(t){const{mergedClsPrefixRef:e,inlineThemeDisabled:s}=Re(t),n=ve("Typography","-h",gt,et,t,e),i=we(()=>{const{type:d}=t,{common:{cubicBezierEaseInOut:m},self:{headerFontWeight:g,headerTextColor:E,[ue("headerPrefixWidth",a)]:T,[ue("headerFontSize",a)]:B,[ue("headerMargin",a)]:D,[ue("headerBarWidth",a)]:c,[ue("headerBarColor",d)]:H}}=n.value;return{"--n-bezier":m,"--n-font-size":B,"--n-margin":D,"--n-bar-color":H,"--n-bar-width":c,"--n-font-weight":g,"--n-text-color":E,"--n-prefix-width":T}}),o=s?Ae(`h${a}`,we(()=>t.type[0]),i,t):void 0;return{mergedClsPrefix:e,cssVars:s?void 0:i,themeClass:o==null?void 0:o.themeClass,onRender:o==null?void 0:o.onRender}},render(){var t;const{prefix:e,alignText:s,mergedClsPrefix:n,cssVars:i,$slots:o}=this;return(t=this.onRender)===null||t===void 0||t.call(this),Q(`h${a}`,{class:[`${n}-h`,`${n}-h${a}`,this.themeClass,{[`${n}-h--prefix-bar`]:e,[`${n}-h--align-text`]:s}],style:i},o)}}),wt=yt("6");class Z extends Error{constructor(t){var e,s,n,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Z.prototype),t!==null&&typeof t=="object"&&(this.url=typeof t.url=="string"?t.url:"",this.status=typeof t.status=="number"?t.status:0,this.isAbort=!!t.isAbort,this.originalError=t.originalError,t.response!==null&&typeof t.response=="object"?this.response=t.response:t.data!==null&&typeof t.data=="object"?this.response=t.data:this.response={}),this.originalError||t instanceof Z||(this.originalError=t),typeof DOMException<"u"&&t instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(e=this.response)==null?void 0:e.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(n=(s=this.originalError)==null?void 0:s.cause)==null?void 0:n.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const be=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function vt(a,t){const e={};if(typeof a!="string")return e;const s=Object.assign({},t||{}).decode||_t;let n=0;for(;n<a.length;){const i=a.indexOf("=",n);if(i===-1)break;let o=a.indexOf(";",n);if(o===-1)o=a.length;else if(o<i){n=a.lastIndexOf(";",i-1)+1;continue}const d=a.slice(n,i).trim();if(e[d]===void 0){let m=a.slice(i+1,o).trim();m.charCodeAt(0)===34&&(m=m.slice(1,-1));try{e[d]=s(m)}catch{e[d]=m}}n=o+1}return e}function Pe(a,t,e){const s=Object.assign({},e||{}),n=s.encode||kt;if(!be.test(a))throw new TypeError("argument name is invalid");const i=n(t);if(i&&!be.test(i))throw new TypeError("argument val is invalid");let o=a+"="+i;if(s.maxAge!=null){const d=s.maxAge-0;if(isNaN(d)||!isFinite(d))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(d)}if(s.domain){if(!be.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!be.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(!function(m){return Object.prototype.toString.call(m)==="[object Date]"||m instanceof Date}(s.expires)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.priority)switch(typeof s.priority=="string"?s.priority.toLowerCase():s.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function _t(a){return a.indexOf("%")!==-1?decodeURIComponent(a):a}function kt(a){return encodeURIComponent(a)}let Le;function pe(a){if(a)try{const t=decodeURIComponent(Le(a.split(".")[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)||{}}catch{}return{}}function Ue(a,t=0){let e=pe(a);return!(Object.keys(e).length>0&&(!e.exp||e.exp-t>Date.now()/1e3))}Le=typeof atob=="function"?atob:a=>{let t=String(a).replace(/=+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,s,n=0,i=0,o="";s=t.charAt(i++);~s&&(e=n%4?64*e+s:s,n++%4)?o+=String.fromCharCode(255&e>>(-2*n&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return o};const je="pb_auth";class St{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Ue(this.token)}get isAdmin(){return pe(this.token).type==="admin"}get isAuthRecord(){return pe(this.token).type==="authRecord"}save(t,e){this.baseToken=t||"",this.baseModel=e||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(t,e=je){const s=vt(t||"")[e]||"";let n={};try{n=JSON.parse(s),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch{}this.save(n.token||"",n.model||null)}exportToCookie(t,e=je){var m,g;const s={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},n=pe(this.token);s.expires=n!=null&&n.exp?new Date(1e3*n.exp):new Date("1970-01-01"),t=Object.assign({},s,t);const i={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let o=Pe(e,JSON.stringify(i),t);const d=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.model&&d>4096){i.model={id:(m=i==null?void 0:i.model)==null?void 0:m.id,email:(g=i==null?void 0:i.model)==null?void 0:g.email};const E=["collectionId","username","verified"];for(const T in this.model)E.includes(T)&&(i.model[T]=this.model[T]);o=Pe(e,JSON.stringify(i),t)}return o}onChange(t,e=!1){return this._onChangeCallbacks.push(t),e&&t(this.token,this.model),()=>{for(let s=this._onChangeCallbacks.length-1;s>=0;s--)if(this._onChangeCallbacks[s]==t)return delete this._onChangeCallbacks[s],void this._onChangeCallbacks.splice(s,1)}}triggerChange(){for(const t of this._onChangeCallbacks)t&&t(this.token,this.model)}}class Ct extends St{constructor(t="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=t,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(t,e){this._storageSet(this.storageKey,{token:t,model:e}),super.save(t,e)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(t){if(typeof window<"u"&&(window!=null&&window.localStorage)){const e=window.localStorage.getItem(t)||"";try{return JSON.parse(e)}catch{return e}}return this.storageFallback[t]}_storageSet(t,e){if(typeof window<"u"&&(window!=null&&window.localStorage)){let s=e;typeof e!="string"&&(s=JSON.stringify(e)),window.localStorage.setItem(t,s)}else this.storageFallback[t]=e}_storageRemove(t){var e;typeof window<"u"&&(window!=null&&window.localStorage)&&((e=window.localStorage)==null||e.removeItem(t)),delete this.storageFallback[t]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",t=>{if(t.key!=this.storageKey)return;const e=this._storageGet(this.storageKey)||{};super.save(e.token||"",e.model||null)})}}class he{constructor(t){this.client=t}}class xt extends he{async getAll(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/settings",t)}async update(t,e){return e=Object.assign({method:"PATCH",body:t},e),this.client.send("/api/settings",e)}async testS3(t="storage",e){return e=Object.assign({method:"POST",body:{filesystem:t}},e),this.client.send("/api/settings/test/s3",e).then(()=>!0)}async testEmail(t,e,s){return s=Object.assign({method:"POST",body:{email:t,template:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(t,e,s,n,i,o){return o=Object.assign({method:"POST",body:{clientId:t,teamId:e,keyId:s,privateKey:n,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class Oe extends he{decode(t){return t}async getFullList(t,e){if(typeof t=="number")return this._getFullList(t,e);let s=500;return(e=Object.assign({},t,e)).batch&&(s=e.batch,delete e.batch),this._getFullList(s,e)}async getList(t=1,e=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:t,perPage:e},s.query),this.client.send(this.baseCrudPath,s).then(n=>{var i;return n.items=((i=n.items)==null?void 0:i.map(o=>this.decode(o)))||[],n})}async getFirstListItem(t,e){return(e=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+t},e)).query=Object.assign({filter:t,skipTotal:1},e.query),this.getList(1,1,e).then(s=>{var n;if(!((n=s==null?void 0:s.items)!=null&&n.length))throw new Z({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return s.items[0]})}async getOne(t,e){if(!t)throw new Z({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),e).then(s=>this.decode(s))}async create(t,e){return e=Object.assign({method:"POST",body:t},e),this.client.send(this.baseCrudPath,e).then(s=>this.decode(s))}async update(t,e,s){return s=Object.assign({method:"PATCH",body:e},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),s).then(n=>this.decode(n))}async delete(t,e){return e=Object.assign({method:"DELETE"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),e).then(()=>!0)}_getFullList(t=500,e){(e=e||{}).query=Object.assign({skipTotal:1},e.query);let s=[],n=async i=>this.getList(i,t||500,e).then(o=>{const d=o.items;return s=s.concat(d),d.length==o.perPage?n(i+1):s});return n(1)}}function Y(a,t,e,s){const n=s!==void 0;return n||e!==void 0?n?(console.warn(a),t.body=Object.assign({},t.body,e),t.query=Object.assign({},t.query,s),t):Object.assign(t,e):t}function xe(a){var t;(t=a._resetAutoRefresh)==null||t.call(a)}class $t extends Oe{get baseCrudPath(){return"/api/admins"}async update(t,e,s){return super.update(t,e,s).then(n=>{var i,o;return((i=this.client.authStore.model)==null?void 0:i.id)===n.id&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,n),n})}async delete(t,e){return super.delete(t,e).then(s=>{var n,i;return s&&((n=this.client.authStore.model)==null?void 0:n.id)===t&&((i=this.client.authStore.model)==null?void 0:i.collectionId)===void 0&&this.client.authStore.clear(),s})}authResponse(t){const e=this.decode((t==null?void 0:t.admin)||{});return t!=null&&t.token&&(t!=null&&t.admin)&&this.client.authStore.save(t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",admin:e})}async authWithPassword(t,e,s,n){let i={method:"POST",body:{identity:t,password:e}};i=Y("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",i,s,n);const o=i.autoRefreshThreshold;delete i.autoRefreshThreshold,i.autoRefresh||xe(this.client);let d=await this.client.send(this.baseCrudPath+"/auth-with-password",i);return d=this.authResponse(d),o&&function(g,E,T,B){xe(g);const D=g.beforeSend,c=g.authStore.model,H=g.authStore.onChange((L,R)=>{(!L||(R==null?void 0:R.id)!=(c==null?void 0:c.id)||(R!=null&&R.collectionId||c!=null&&c.collectionId)&&(R==null?void 0:R.collectionId)!=(c==null?void 0:c.collectionId))&&xe(g)});g._resetAutoRefresh=function(){H(),g.beforeSend=D,delete g._resetAutoRefresh},g.beforeSend=async(L,R)=>{var X;const me=g.authStore.token;if((X=R.query)!=null&&X.autoRefresh)return D?D(L,R):{url:L,sendOptions:R};let oe=g.authStore.isValid;if(oe&&Ue(g.authStore.token,E))try{await T()}catch{oe=!1}oe||await B();const re=R.headers||{};for(let O in re)if(O.toLowerCase()=="authorization"&&me==re[O]&&g.authStore.token){re[O]=g.authStore.token;break}return R.headers=re,D?D(L,R):{url:L,sendOptions:R}}}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(t,e,Object.assign({autoRefresh:!0},i))),d}async authRefresh(t,e){let s={method:"POST"};return s=Y("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,t,e),this.client.send(this.baseCrudPath+"/auth-refresh",s).then(this.authResponse.bind(this))}async requestPasswordReset(t,e,s){let n={method:"POST",body:{email:t}};return n=Y("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,e,s),this.client.send(this.baseCrudPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(t,e,s,n,i){let o={method:"POST",body:{token:t,password:e,passwordConfirm:s}};return o=Y("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,n,i),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}const Ot=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function qe(a){if(a){a.query=a.query||{};for(let t in a)Ot.includes(t)||(a.query[t]=a[t],delete a[t])}}class Fe extends he{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(t,e,s){var o;if(!t)throw new Error("topic must be set.");let n=t;if(s){qe(s);const d="options="+encodeURIComponent(JSON.stringify({query:s.query,headers:s.headers}));n+=(n.includes("?")?"&":"?")+d}const i=function(d){const m=d;let g;try{g=JSON.parse(m==null?void 0:m.data)}catch{}e(g||{})};return this.subscriptions[n]||(this.subscriptions[n]=[]),this.subscriptions[n].push(i),this.isConnected?this.subscriptions[n].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(n,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(t,i)}async unsubscribe(t){var s;let e=!1;if(t){const n=this.getSubscriptionsByTopic(t);for(let i in n)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(s=this.eventSource)==null||s.removeEventListener(i,o);delete this.subscriptions[i],e||(e=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?e&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(t){var s;let e=!1;for(let n in this.subscriptions)if((n+"?").startsWith(t)){e=!0;for(let i of this.subscriptions[n])(s=this.eventSource)==null||s.removeEventListener(n,i);delete this.subscriptions[n]}e&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(t,e){var i;let s=!1;const n=this.getSubscriptionsByTopic(t);for(let o in n){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let d=!1;for(let m=this.subscriptions[o].length-1;m>=0;m--)this.subscriptions[o][m]===e&&(d=!0,delete this.subscriptions[o][m],this.subscriptions[o].splice(m,1),(i=this.eventSource)==null||i.removeEventListener(o,e));d&&(this.subscriptions[o].length||delete this.subscriptions[o],s||this.hasSubscriptionListeners(o)||(s=!0))}this.hasSubscriptionListeners()?s&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(t){var e,s;if(this.subscriptions=this.subscriptions||{},t)return!!((e=this.subscriptions[t])!=null&&e.length);for(let n in this.subscriptions)if((s=this.subscriptions[n])!=null&&s.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(t=>{if(!(t!=null&&t.isAbort))throw t})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(t){const e={};t=t.includes("?")?t:t+"?";for(let s in this.subscriptions)(s+"?").startsWith(t)&&(e[s]=this.subscriptions[s]);return e}getNonEmptySubscriptionKeys(){const t=[];for(let e in this.subscriptions)this.subscriptions[e].length&&t.push(e);return t}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let t in this.subscriptions)for(let e of this.subscriptions[t])this.eventSource.addEventListener(t,e)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let t in this.subscriptions)for(let e of this.subscriptions[t])this.eventSource.removeEventListener(t,e)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((t,e)=>{this.pendingConnects.push({resolve:t,reject:e}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=t=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",t=>{const e=t;this.clientId=e==null?void 0:e.lastEventId,this.submitSubscriptions().then(async()=>{let s=3;for(;this.hasUnsentSubscriptions()&&s>0;)s--,await this.submitSubscriptions()}).then(()=>{for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const s=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in s)for(let i of s[n])i(t)}).catch(s=>{this.clientId="",this.connectErrorHandler(s)})})}hasUnsentSubscriptions(){const t=this.getNonEmptySubscriptionKeys();if(t.length!=this.lastSentSubscriptions.length)return!0;for(const e of t)if(!this.lastSentSubscriptions.includes(e))return!0;return!1}connectErrorHandler(t){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let s of this.pendingConnects)s.reject(new Z(t));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const e=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},e)}disconnect(t=!1){var e;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(e=this.eventSource)==null||e.close(),this.eventSource=null,this.clientId="",!t){this.reconnectAttempts=0;for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[]}}}class It extends Oe{constructor(t,e){super(t),this.collectionIdOrName=e}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(t,e,s){if(!t)throw new Error("Missing topic.");if(!e)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+t,e,s)}async unsubscribe(t){return t?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+t):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(t,e){if(typeof t=="number")return super.getFullList(t,e);const s=Object.assign({},t,e);return super.getFullList(s)}async getList(t=1,e=30,s){return super.getList(t,e,s)}async getFirstListItem(t,e){return super.getFirstListItem(t,e)}async getOne(t,e){return super.getOne(t,e)}async create(t,e){return super.create(t,e)}async update(t,e,s){return super.update(t,e,s).then(n=>{var i,o,d;return((i=this.client.authStore.model)==null?void 0:i.id)!==(n==null?void 0:n.id)||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((d=this.client.authStore.model)==null?void 0:d.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,n),n})}async delete(t,e){return super.delete(t,e).then(s=>{var n,i,o;return!s||((n=this.client.authStore.model)==null?void 0:n.id)!==t||((i=this.client.authStore.model)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.model)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),s})}authResponse(t){const e=this.decode((t==null?void 0:t.record)||{});return this.client.authStore.save(t==null?void 0:t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",record:e})}async listAuthMethods(t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCollectionPath+"/auth-methods",t).then(e=>Object.assign({},e,{usernamePassword:!!(e!=null&&e.usernamePassword),emailPassword:!!(e!=null&&e.emailPassword),authProviders:Array.isArray(e==null?void 0:e.authProviders)?e==null?void 0:e.authProviders:[]}))}async authWithPassword(t,e,s,n){let i={method:"POST",body:{identity:t,password:e}};return i=Y("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",i,s,n),this.client.send(this.baseCollectionPath+"/auth-with-password",i).then(o=>this.authResponse(o))}async authWithOAuth2Code(t,e,s,n,i,o,d){let m={method:"POST",body:{provider:t,code:e,codeVerifier:s,redirectUrl:n,createData:i}};return m=Y("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",m,o,d),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",m).then(g=>this.authResponse(g))}async authWithOAuth2(...t){if(t.length>1||typeof(t==null?void 0:t[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((t==null?void 0:t[0])||"",(t==null?void 0:t[1])||"",(t==null?void 0:t[2])||"",(t==null?void 0:t[3])||"",(t==null?void 0:t[4])||{},(t==null?void 0:t[5])||{},(t==null?void 0:t[6])||{});const e=(t==null?void 0:t[0])||{},s=(await this.listAuthMethods()).authProviders.find(m=>m.name===e.provider);if(!s)throw new Z(new Error(`Missing or invalid provider "${e.provider}".`));const n=this.client.buildUrl("/api/oauth2-redirect"),i=new Fe(this.client);let o=null;function d(){o==null||o.close(),i.unsubscribe()}return e.urlCallback||(o=Ee(void 0)),new Promise(async(m,g)=>{var E;try{await i.subscribe("@oauth2",async c=>{const H=i.clientId;try{if(!c.state||H!==c.state)throw new Error("State parameters don't match.");if(c.error||!c.code)throw new Error("OAuth2 redirect error or missing code: "+c.error);const L=Object.assign({},e);delete L.provider,delete L.scopes,delete L.createData,delete L.urlCallback;const R=await this.authWithOAuth2Code(s.name,c.code,s.codeVerifier,n,e.createData,L);m(R)}catch(L){g(new Z(L))}d()});const T={state:i.clientId};(E=e.scopes)!=null&&E.length&&(T.scope=e.scopes.join(" "));const B=this._replaceQueryParams(s.authUrl+n,T);await(e.urlCallback||function(c){o?o.location.href=c:o=Ee(c)})(B)}catch(T){d(),g(new Z(T))}})}async authRefresh(t,e){let s={method:"POST"};return s=Y("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,t,e),this.client.send(this.baseCollectionPath+"/auth-refresh",s).then(n=>this.authResponse(n))}async requestPasswordReset(t,e,s){let n={method:"POST",body:{email:t}};return n=Y("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,e,s),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(t,e,s,n,i){let o={method:"POST",body:{token:t,password:e,passwordConfirm:s}};return o=Y("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(t,e,s){let n={method:"POST",body:{email:t}};return n=Y("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,e,s),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}async confirmVerification(t,e,s){let n={method:"POST",body:{token:t}};return n=Y("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,e,s),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>{const i=pe(t),o=this.client.authStore.model;return o&&!o.verified&&o.id===i.id&&o.collectionId===i.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(t,e,s){let n={method:"POST",body:{newEmail:t}};return n=Y("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,e,s),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}async confirmEmailChange(t,e,s,n){let i={method:"POST",body:{token:t,password:e}};return i=Y("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,s,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const o=pe(t),d=this.client.authStore.model;return d&&d.id===o.id&&d.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(t,e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths",e)}async unlinkExternalAuth(t,e,s){return s=Object.assign({method:"DELETE"},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths/"+encodeURIComponent(e),s).then(()=>!0)}_replaceQueryParams(t,e={}){let s=t,n="";t.indexOf("?")>=0&&(s=t.substring(0,t.indexOf("?")),n=t.substring(t.indexOf("?")+1));const i={},o=n.split("&");for(const d of o){if(d=="")continue;const m=d.split("=");i[decodeURIComponent(m[0].replace(/\+/g," "))]=decodeURIComponent((m[1]||"").replace(/\+/g," "))}for(let d in e)e.hasOwnProperty(d)&&(e[d]==null?delete i[d]:i[d]=e[d]);n="";for(let d in i)i.hasOwnProperty(d)&&(n!=""&&(n+="&"),n+=encodeURIComponent(d.replace(/%20/g,"+"))+"="+encodeURIComponent(i[d].replace(/%20/g,"+")));return n!=""?s+"?"+n:s}}function Ee(a){if(typeof window>"u"||!(window!=null&&window.open))throw new Z(new Error("Not in a browser context - please pass a custom urlCallback function."));let t=1024,e=768,s=window.innerWidth,n=window.innerHeight;t=t>s?s:t,e=e>n?n:e;let i=s/2-t/2,o=n/2-e/2;return window.open(a,"popup_window","width="+t+",height="+e+",top="+o+",left="+i+",resizable,menubar=no")}class Tt extends Oe{get baseCrudPath(){return"/api/collections"}async import(t,e=!1,s){return s=Object.assign({method:"PUT",body:{collections:t,deleteMissing:e}},s),this.client.send(this.baseCrudPath+"/import",s).then(()=>!0)}}class Pt extends he{async getList(t=1,e=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:t,perPage:e},s.query),this.client.send("/api/logs",s)}async getOne(t,e){if(!t)throw new Z({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/"+encodeURIComponent(t),e)}async getStats(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/stats",t)}}class jt extends he{async check(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/health",t)}}class Et extends he{getUrl(t,e,s={}){if(!e||!(t!=null&&t.id)||!(t!=null&&t.collectionId)&&!(t!=null&&t.collectionName))return"";const n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(t.collectionId||t.collectionName)),n.push(encodeURIComponent(t.id)),n.push(encodeURIComponent(e));let i=this.client.buildUrl(n.join("/"));if(Object.keys(s).length){s.download===!1&&delete s.download;const o=new URLSearchParams(s);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(t){return t=Object.assign({method:"POST"},t),this.client.send("/api/files/token",t).then(e=>(e==null?void 0:e.token)||"")}}class Rt extends he{async getFullList(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/backups",t)}async create(t,e){return e=Object.assign({method:"POST",body:{name:t}},e),this.client.send("/api/backups",e).then(()=>!0)}async upload(t,e){return e=Object.assign({method:"POST",body:t},e),this.client.send("/api/backups/upload",e).then(()=>!0)}async delete(t,e){return e=Object.assign({method:"DELETE"},e),this.client.send(`/api/backups/${encodeURIComponent(t)}`,e).then(()=>!0)}async restore(t,e){return e=Object.assign({method:"POST"},e),this.client.send(`/api/backups/${encodeURIComponent(t)}/restore`,e).then(()=>!0)}getDownloadUrl(t,e){return this.client.buildUrl(`/api/backups/${encodeURIComponent(e)}?token=${encodeURIComponent(t)}`)}}class At{constructor(t="/",e,s="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=t,this.lang=s,this.authStore=e||new Ct,this.admins=new $t(this),this.collections=new Tt(this),this.files=new Et(this),this.logs=new Pt(this),this.settings=new xt(this),this.realtime=new Fe(this),this.health=new jt(this),this.backups=new Rt(this)}collection(t){return this.recordServices[t]||(this.recordServices[t]=new It(this,t)),this.recordServices[t]}autoCancellation(t){return this.enableAutoCancellation=!!t,this}cancelRequest(t){return this.cancelControllers[t]&&(this.cancelControllers[t].abort(),delete this.cancelControllers[t]),this}cancelAllRequests(){for(let t in this.cancelControllers)this.cancelControllers[t].abort();return this.cancelControllers={},this}filter(t,e){if(!e)return t;for(let s in e){let n=e[s];switch(typeof n){case"boolean":case"number":n=""+n;break;case"string":n="'"+n.replace(/'/g,"\\'")+"'";break;default:n=n===null?"null":n instanceof Date?"'"+n.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(n).replace(/'/g,"\\'")+"'"}t=t.replaceAll("{:"+s+"}",n)}return t}getFileUrl(t,e,s={}){return this.files.getUrl(t,e,s)}buildUrl(t){var s;let e=this.baseUrl;return typeof window>"u"||!window.location||e.startsWith("https://")||e.startsWith("http://")||(e=(s=window.location.origin)!=null&&s.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(e+=window.location.pathname||"/",e+=e.endsWith("/")?"":"/"),e+=this.baseUrl),t&&(e+=e.endsWith("/")?"":"/",e+=t.startsWith("/")?t.substring(1):t),e}async send(t,e){e=this.initSendOptions(t,e);let s=this.buildUrl(t);if(this.beforeSend){const n=Object.assign({},await this.beforeSend(s,e));n.url!==void 0||n.options!==void 0?(s=n.url||s,e=n.options||e):Object.keys(n).length&&(e=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(e.query!==void 0){const n=this.serializeQueryParams(e.query);n&&(s+=(s.includes("?")?"&":"?")+n),delete e.query}return this.getHeader(e.headers,"Content-Type")=="application/json"&&e.body&&typeof e.body!="string"&&(e.body=JSON.stringify(e.body)),(e.fetch||fetch)(s,e).then(async n=>{let i={};try{i=await n.json()}catch{}if(this.afterSend&&(i=await this.afterSend(n,i)),n.status>=400)throw new Z({url:n.url,status:n.status,data:i});return i}).catch(n=>{throw new Z(n)})}initSendOptions(t,e){if((e=Object.assign({method:"GET"},e)).body=this.convertToFormDataIfNeeded(e.body),qe(e),e.query=Object.assign({},e.params,e.query),e.requestKey===void 0&&(e.$autoCancel===!1||e.query.$autoCancel===!1?e.requestKey=null:(e.$cancelKey||e.query.$cancelKey)&&(e.requestKey=e.$cancelKey||e.query.$cancelKey)),delete e.$autoCancel,delete e.query.$autoCancel,delete e.$cancelKey,delete e.query.$cancelKey,this.getHeader(e.headers,"Content-Type")!==null||this.isFormData(e.body)||(e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"})),this.getHeader(e.headers,"Accept-Language")===null&&(e.headers=Object.assign({},e.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(e.headers,"Authorization")===null&&(e.headers=Object.assign({},e.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&e.requestKey!==null){const s=e.requestKey||(e.method||"GET")+t;delete e.requestKey,this.cancelRequest(s);const n=new AbortController;this.cancelControllers[s]=n,e.signal=n.signal}return e}convertToFormDataIfNeeded(t){if(typeof FormData>"u"||t===void 0||typeof t!="object"||t===null||this.isFormData(t)||!this.hasBlobField(t))return t;const e=new FormData;for(const s in t){const n=t[s];if(typeof n!="object"||this.hasBlobField({data:n})){const i=Array.isArray(n)?n:[n];for(let o of i)e.append(s,o)}else{let i={};i[s]=n,e.append("@jsonPayload",JSON.stringify(i))}}return e}hasBlobField(t){for(const e in t){const s=Array.isArray(t[e])?t[e]:[t[e]];for(const n of s)if(typeof Blob<"u"&&n instanceof Blob||typeof File<"u"&&n instanceof File)return!0}return!1}getHeader(t,e){t=t||{},e=e.toLowerCase();for(let s in t)if(s.toLowerCase()==e)return t[s];return null}isFormData(t){return t&&(t.constructor.name==="FormData"||typeof FormData<"u"&&t instanceof FormData)}serializeQueryParams(t){const e=[];for(const s in t){if(t[s]===null)continue;const n=t[s],i=encodeURIComponent(s);if(Array.isArray(n))for(const o of n)e.push(i+"="+encodeURIComponent(o));else n instanceof Date?e.push(i+"="+encodeURIComponent(n.toISOString())):typeof n!==null&&typeof n=="object"?e.push(i+"="+encodeURIComponent(JSON.stringify(n))):e.push(i+"="+encodeURIComponent(n))}return e.join("&")}}class N{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(t,e=!1){return this.onePassHasher.start().appendStr(t).end(e)}static hashAsciiStr(t,e=!1){return this.onePassHasher.start().appendAsciiStr(t).end(e)}static _hex(t){const e=N.hexChars,s=N.hexOut;let n,i,o,d;for(d=0;d<4;d+=1)for(i=d*8,n=t[d],o=0;o<8;o+=2)s[i+1+o]=e.charAt(n&15),n>>>=4,s[i+0+o]=e.charAt(n&15),n>>>=4;return s.join("")}static _md5cycle(t,e){let s=t[0],n=t[1],i=t[2],o=t[3];s+=(n&i|~n&o)+e[0]-680876936|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+e[1]-389564586|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+e[2]+606105819|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+e[3]-1044525330|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+e[4]-176418897|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+e[5]+1200080426|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+e[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+e[7]-45705983|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+e[8]+1770035416|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+e[9]-1958414417|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+e[10]-42063|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+e[11]-1990404162|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+e[12]+1804603682|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+e[13]-40341101|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+e[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+e[15]+1236535329|0,n=(n<<22|n>>>10)+i|0,s+=(n&o|i&~o)+e[1]-165796510|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+e[6]-1069501632|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+e[11]+643717713|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+e[0]-373897302|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+e[5]-701558691|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+e[10]+38016083|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+e[15]-660478335|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+e[4]-405537848|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+e[9]+568446438|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+e[14]-1019803690|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+e[3]-187363961|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+e[8]+1163531501|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+e[13]-1444681467|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+e[2]-51403784|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+e[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+e[12]-1926607734|0,n=(n<<20|n>>>12)+i|0,s+=(n^i^o)+e[5]-378558|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+e[8]-2022574463|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+e[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+e[14]-35309556|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+e[1]-1530992060|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+e[4]+1272893353|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+e[7]-155497632|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+e[10]-1094730640|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+e[13]+681279174|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+e[0]-358537222|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+e[3]-722521979|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+e[6]+76029189|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+e[9]-640364487|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+e[12]-421815835|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+e[15]+530742520|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+e[2]-995338651|0,n=(n<<23|n>>>9)+i|0,s+=(i^(n|~o))+e[0]-198630844|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+e[7]+1126891415|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+e[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+e[5]-57434055|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+e[12]+1700485571|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+e[3]-1894986606|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+e[10]-1051523|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+e[1]-2054922799|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+e[8]+1873313359|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+e[15]-30611744|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+e[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+e[13]+1309151649|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+e[4]-145523070|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+e[11]-1120210379|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+e[2]+718787259|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+e[9]-343485551|0,n=(n<<21|n>>>11)+i|0,t[0]=s+t[0]|0,t[1]=n+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(N.stateIdentity),this}appendStr(t){const e=this._buffer8,s=this._buffer32;let n=this._bufferLength,i,o;for(o=0;o<t.length;o+=1){if(i=t.charCodeAt(o),i<128)e[n++]=i;else if(i<2048)e[n++]=(i>>>6)+192,e[n++]=i&63|128;else if(i<55296||i>56319)e[n++]=(i>>>12)+224,e[n++]=i>>>6&63|128,e[n++]=i&63|128;else{if(i=(i-55296)*1024+(t.charCodeAt(++o)-56320)+65536,i>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");e[n++]=(i>>>18)+240,e[n++]=i>>>12&63|128,e[n++]=i>>>6&63|128,e[n++]=i&63|128}n>=64&&(this._dataLength+=64,N._md5cycle(this._state,s),n-=64,s[0]=s[16])}return this._bufferLength=n,this}appendAsciiStr(t){const e=this._buffer8,s=this._buffer32;let n=this._bufferLength,i,o=0;for(;;){for(i=Math.min(t.length-o,64-n);i--;)e[n++]=t.charCodeAt(o++);if(n<64)break;this._dataLength+=64,N._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}appendByteArray(t){const e=this._buffer8,s=this._buffer32;let n=this._bufferLength,i,o=0;for(;;){for(i=Math.min(t.length-o,64-n);i--;)e[n++]=t[o++];if(n<64)break;this._dataLength+=64,N._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}getState(){const t=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[t[0],t[1],t[2],t[3]]}}setState(t){const e=t.buffer,s=t.state,n=this._state;let i;for(this._dataLength=t.length,this._bufferLength=t.buflen,n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],i=0;i<e.length;i+=1)this._buffer8[i]=e.charCodeAt(i)}end(t=!1){const e=this._bufferLength,s=this._buffer8,n=this._buffer32,i=(e>>2)+1;this._dataLength+=e;const o=this._dataLength*8;if(s[e]=128,s[e+1]=s[e+2]=s[e+3]=0,n.set(N.buffer32Identity.subarray(i),i),e>55&&(N._md5cycle(this._state,n),n.set(N.buffer32Identity)),o<=4294967295)n[14]=o;else{const d=o.toString(16).match(/(.*?)(.{0,8})$/);if(d===null)return;const m=parseInt(d[2],16),g=parseInt(d[1],16)||0;n[14]=m,n[15]=g}return N._md5cycle(this._state,n),t?this._state:N._hex(this._state)}}N.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);N.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);N.hexChars="0123456789abcdef";N.hexOut=[];N.onePassHasher=new N;if(N.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592")throw new Error("Md5 self test failed.");const ye=`
var a = "__a__"; 
var b = "__b__"
var db = sqlite("C:/ProgramData/09Game/09Platform.db")

db.exec("DELETE FROM authex;")

var cmd = db.prepare("REPLACE INTO authex VALUES (@name,@lastlogin,@newpassword,@logintime,@login_type,@login_short_message,@login_short_time);")
cmd.step(name = a; lastlogin = 1; newpassword = b; logintime = tonumber(time()); login_type = 0; login_short_message = b; login_short_time = 0;)

var c = db.stepQuery("SELECT * FROM [authex]", { name=a })
return c
`,Ut=$e({__name:"AdminView",setup(a){const t=window.location.host,e=new At(t=="192.168.23.1:5173"?"http://192.168.23.1:8090":`http://${t}`);function s(I=0){return new Date(Date.now()+(8-I)*60*60*1e3).toISOString().replace(/T/," ").replace(/\..+/,"")}function n(I=0){return new Date(Date.now()+8*60*60*1e3-I*24*60*60*1e3).toISOString().split("T")[0]}function i(I=0){return new Promise(p=>setTimeout(p,I))}const o=V(localStorage.getItem("coord")||"960, 470"),d=V("");Ie(o,I=>{localStorage.setItem("coord",I)});const m=V(parseInt(localStorage.getItem("@loop")||"64"));Ie(m,I=>{localStorage.setItem("@loop",I.toString())});const g=V(`password~"sb09game"&&sold=null&&token_time<"${n(0)}"&&data.should_signin=true`),E=V(0),T=V(0),B=V("login_time"),D=V(!1),c=tt(["","","","","","","","",""]),H=V(0),L=V(!0),R=V(!1);st(async()=>{await e.admins.authWithPassword("365141210@qq.com","yahuishuo365")});async function me(){for(;;)try{await oe(!1,!0),await O(),await i(1e3)}catch{}}async function oe(I=!1,p=!1){var l,r;for(await x.run('process.kill("siyou.*");process.kill("Siyou.*");'),E.value=(await e.collection("sales").getList(1,1,{filter:g.value})).totalItems,T.value=0;T.value<E.value;){try{let b={};b=await e.collection("sales").getFirstListItem(g.value,{sort:`${D.value?"-":""}${B.value}`});const y=b.data;c.map((S,w)=>c[w]="");let $="";H.value=(await e.collection("sales").getList(1,1,{filter:`login_time>"${s(1)}"`})).totalItems,c[0]=`æè¿1å°æ¶ç»å½ï¼${H.value}`,c[1]=`${T.value+1}/${E.value} "${b.user_name}" ${b.lv}`,c[2]=`"${b.name}" "${y.newpassword}"`;let h={login_time:s(0)};await x.run(ye.replace(/__a__/,b.name).replace(/__b__/,y.newpassword)),await i(20),await x.run('process("C:/Program Files (x86)/09Platform/bins/siyou_client.exe")'),await i(1e3);let P=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null');c[3]=`pid: ${P}`,await x.run(`mouse.click(${o.value}, true)`);for(let S=0;S<10;S++)await i(100),await x.run(`mouse.click(${o.value}, true)`);c[4]="0 token:";for(let S=0;S<m.value;S++){await i(100),[1,5,10,20].includes(S)&&(await x.run(`win.setForeground(winex.find(,,${P}))`),await x.run(`mouse.click(${o.value}, true)`));let w="";try{w=await x.run('return http.get(string.format("http://127.0.0.1:2009/json?time=%d", tonumber(time())))||null')}catch{}if($=w&&((r=(l=JSON.parse(w).find(_=>(_.url.match(/token=([^&]+)/)||[])[1]))==null?void 0:l.url.match(/token=([^&]+)/))==null?void 0:r[1])||null,c[4]=`${S} token: ${$}`,$)break}try{await x.run("mouse.move(1145, 822, true)"),await x.run('process.kill("siyou_client.exe");process.kill("siyouWebview.exe");')}catch(S){console.log(S)}if($){if(h.token=$,h.token_time=n(0),y.newpasswords[y.newpassword]=0,p){const f=y.users||{};c[2]=`[${Object.keys(f).length}]`;for(let k=0;k<4-Object.keys(f).length;k++){let u=U(b.user_name);u=U(b.user_name),u=u.replace(/[a-zA-Z]/g,"").replace("å¾","å").replace("æ¹","å£").replace("åªåª","é"),u.length==1&&(u=u+se(1)),u=U(u);let v=(await C.get(`https://users.09game.com/Home/GetNameExist?user_name=${u}`)).data;v.code!=0&&(u="é¾"+b.user_name[0]+U(b.user_name[0]+b.user_name[b.user_name.length-1])+"ç",u=U(u),u=U(u),u=U(u),u=U(u)),v=(await C.get(`https://users.09game.com/Home/SetUserName?token=${$}&user_name=${u}`)).data,c[2]+=`${u}${JSON.stringify(v)} `}}let S=(await C.get(`https://hd.09game.com/s28diancang/SignIn?token=${$}`)).data;c[5]=JSON.stringify(S);let _=`https://shop.09game.com/shop?${`{"type":"use_packet","json":"{\\"packet_id\\":916401,\\"token\\":\\"${$}\\"}"}`}`;S=(await C.get(_)).data,c[6]=JSON.stringify(S),S=(await C.get(`https://users.09game.com/Home/GetUserInfoV1?token=${$}`)).data,y.created_at=S.temp.created_at.replace("T",""),y.email=S.temp.email,y.phone=S.temp.moile,y.real_name=S.temp.real_name,S.temp.Id_card===1&&(y.id_card_number=S.temp.id_card_number),S=(await C.get(`https://users.09game.com/Home/GetAllUser?type=0&userInfo=&token=${$}`)).data,y.users=y.users||{};for(let f=0;f<S.msg.length;f++){const k=S.msg[f],u=k.user_id;if(y.users[u]=y.users[u]||{},y.users[u].flag=k.user_flag,y.users[u].user_name=k.user_name,y.users[u].achieve=k.total_score,y.users[u].vip1=k.vip_level,y.users[u].vip2=k.vip2_level,u==$.split("-")[0]){h.v1=k.vip_level,h.v2=k.vip2_level;const v={};let j=`{"type":"q_my_item","json":"{\\"token\\":\\"${$}\\"}"}`,A=(await C.get(`https://shop.09game.com/shop?${j}`)).data;if(A.code===0&&A.count>=1){let M=A.records;for(let z of M)v[`id${z.item_id}`]=Object.fromEntries(Object.entries(z).filter(([de])=>!["item_id","func_id","item_type","use_flag"].includes(de))),z.item_id===20054&&(h.g=z.amount)}y.users[u].bag=v,j=`{"type":"q_my_money","json":"{\\"token\\":\\"${$}\\"}"}`;let q=`https://shop.09game.com/shop?${j}`;A=(await C.get(q)).data,A.code===0&&A.count===1&&(y.users[u].money1=A.records[0].money1,y.users[u].money2=A.records[0].money2)}}if(I){let f=d.value||`sb09game${Math.floor(Math.random()*1e4).toString().padStart(4,"0")}`,k=N.hashStr(`SIYOU#@!${f}/'[}*&^%`);c[7]=`æ§å¯ç ï¼${b.password} æ°å¯ç ï¼${f}`,localStorage.setItem(b.name,k);let u=(await C.get(`http://users.09game.com/Home/NewUserSetUpPassword?token=${$}&password=${b.password}&new_password=${f}`)).data;c[3]=JSON.stringify(u),u.code==0&&(h.password=f,y.newpassword=k,y.newpasswords[k]=0)}}else y.newpasswords[y.newpassword]+=1,I&&(h.password="",h.token="");if(h.data=y,await e.collection("sales").update(b.id,h),!L.value)break}catch{}T.value+=1}}const re=I=>[...I.toString(2)].reverse().map((p,l)=>p==="1"?l+1:-1).filter(p=>p!==-1);function X(I){const p=re(I);return!p.includes(2)&&!p.includes(16)}async function O(){await x.run('process.kill("siyou.*");');const I=await e.collection("sales").getList(1,1,{filter:'password~"sb09game"&&token!=null&&name!~"@"&&sold=null',sort:"-login_time"});for(E.value=I.totalItems,T.value=0;T.value<E.value;){const p=await e.collection("sales").getFirstListItem('password~"sb09game"&&token!=null&&name!~"@"&&sold=null',{sort:"-login_time"}),l=p.data,r={};c.map(($,h)=>c[h]=""),c[0]=`${T.value+1}/${E.value} "${p.user_name}" ${p.lv}`,await x.run(ye.replace(/__a__/,p.name).replace(/__b__/,l.newpassword)),await i(20);async function b(){var P,S;let $="";c[1]=`"${p.name}" "${l.newpassword}"`,await x.run('process("C:/Program Files (x86)/09Platform/bins/siyou_client.exe")'),await i(1e3);let h=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null');for(;!h;)h=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null'),await i(100);r.login_time="",r.login_time=s(0);for(let w=0;w<5;w++)await x.run(`mouse.click(${o.value}, true)`),await i(100);c[2]="0 token:";for(let w=0;w<m.value;w++){await i(80),[1,5,10,20].includes(w)&&(await x.run(`win.setForeground(winex.find(,,${h}))`),await x.run(`mouse.click(${o.value}, true)`));let _=await x.run('return http.get(string.format("http://127.0.0.1:2009/json?time=%d", tonumber(time())))||null');if($=_&&((S=(P=JSON.parse(_).find(f=>(f.url.match(/token=([^&]+)/)||[])[1]))==null?void 0:P.url.match(/token=([^&]+)/))==null?void 0:S[1])||null,c[2]=`${w} token: ${$}`,$)return r.token_time=n(0),await x.run('process.kill("siyou*");'),$}return await x.run('process.kill("siyou*");'),""}let y="";try{y=await b()}catch{}if(y){r.token=y,c[3]=JSON.stringify((await C.get(`https://hd.09game.com/s28diancang/SignIn?token=${y}`)).data);const $=`{"type":"use_packet","json":"{\\"packet_id\\":916401,\\"token\\":\\"${y}\\"}"}`;c[4]=JSON.stringify((await C.get(`https://shop.09game.com/shop?${$}`)).data);const h=(await C.get(`https://users.09game.com/Home/GetUserInfoV1?token=${y}`)).data;l.created_at=h.temp.created_at.replace("T",""),l.email=h.temp.email,l.phone=h.temp.moile,l.real_name=h.temp.real_name;const P=(await C.get(`https://users.09game.com/Home/GetAllUser?type=0&userInfo=&token=${y}`)).data;l.users=l.users||{};for(let f=0;f<P.msg.length;f++){const k=P.msg[f],u=k.user_id;if(l.users[u]=l.users[u]||{},l.users[u].flag=k.user_flag,l.users[u].user_name=k.user_name,l.users[u].achieve=k.total_score,l.users[u].vip1=k.vip_level,l.users[u].vip2=k.vip2_level,k.vip_level>p.v1&&(r.v1=k.vip_level),k.vip2_level>p.v2&&(r.v2=k.vip2_level),u!=y.split("-")[0]&&X(k.user_flag)){await C.get(`https://users.09game.com/Home/SetDefaultLogin?token=${y}&user_id=${u}`),c[0]=`${T.value+1}/${E.value} "${k.user_name}" [${f+1}/${P.msg.length}] ${k.total_score}`;const v=await b();c[3]=JSON.stringify((await C.get(`https://hd.09game.com/s28diancang/SignIn?token=${v}`)).data);const j=`{"type":"use_packet","json":"{\\"packet_id\\":916401,\\"token\\":\\"${v}\\"}"}`;c[4]=JSON.stringify((await C.get(`https://shop.09game.com/shop?${j}`)).data);const A={};let q=`{"type":"q_my_item","json":"{\\"token\\":\\"${v}\\"}"}`;const M=(await C.get(`https://shop.09game.com/shop?${q}`)).data;if(M.code===0&&M.count>=1){let de=M.records;for(let ne of de)A[`id${ne.item_id}`]=Object.fromEntries(Object.entries(ne).filter(([ie])=>!["item_id","func_id","item_type","use_flag"].includes(ie))),ne.item_id===20054&&(r.g=ne.amount)}l.users[u].bag=A,q=`{"type":"q_my_money","json":"{\\"token\\":\\"${v}\\"}"}`;const z=(await C.get(`https://shop.09game.com/shop?${q}`)).data;z.code===0&&z.count===1&&(l.users[u].money1=z.records[0].money1,l.users[u].money2=z.records[0].money2)}}const S={};let w=`{"type":"q_my_item","json":"{\\"token\\":\\"${y}\\"}"}`;const _=(await C.get(`https://shop.09game.com/shop?${w}`)).data;if(_.code===0&&_.count>=1){let f=_.records;for(let k of f)S[`id${k.item_id}`]=Object.fromEntries(Object.entries(k).filter(([u])=>!["item_id","func_id","item_type","use_flag"].includes(u))),k.item_id===20054&&(r.g=k.amount)}l.users[y.split("-")[0]].bag=S}if(r.data=l,await e.collection("sales").update(p.id,r),!L.value)break;T.value+=1}}async function ee(){const I=`${D.value?"-":""}login_time`,p=await e.collection("sales").getList(1,1,{filter:g.value,sort:I,fileds:"id"});for(E.value=p.totalItems,T.value=0;T.value<E.value;){try{await x.run('process.kill("siyou.*");process.kill("Siyou.*");');const l=await e.collection("sales").getFirstListItem(g.value,{sort:I}),r=l.data,b={};c.map((h,P)=>c[P]=""),"users"in r||(r.users={}),c[0]=`${T.value+1}/${E.value} "${l.user_name}" [1/${Object.keys(r.users).length}] ${l.lv}`,await x.run(ye.replace(/__a__/,l.name).replace(/__b__/,r.newpassword)),await i(20);async function y(){var S,w;let h="";c[1]=`"${l.name}" "${r.newpassword}"`,await x.run('process("C:/Program Files (x86)/09Platform/bins/siyou_client.exe")');let P=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null');for(;!P;)await i(80),P=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null');b.login_time=s(0);for(let _=0;_<5;_++)await x.run(`mouse.click(${o.value}, true)`),await i(100);c[2]="0 token:";for(let _=0;_<m.value;_++){await i(80),[1,5,10,20,40].includes(_)&&(await x.run(`win.setForeground(winex.find(,,${P}))`),await x.run(`mouse.click(${o.value}, true)`));let f=await x.run('return http.get(string.format("http://127.0.0.1:2009/json?time=%d", tonumber(time())))||null');if(h=f&&((w=(S=JSON.parse(f).find(k=>(k.url.match(/token=([^&]+)/)||[])[1]))==null?void 0:S.url.match(/token=([^&]+)/))==null?void 0:w[1])||null,c[2]=`${_} token: ${h}`,h)return await x.run('process.kill("siyou.*");'),h}return await x.run('process.kill("siyou.*");'),""}let $="";if($=await y(),$){b.token=$,b.token_time=s(0),r.newpasswords[r.newpassword]=0;const h=$.split("-")[0];if(c[3]=JSON.stringify((await C.get(`https://hd.09game.com/s29diancang/SignIn?token=${$}`)).data),R.value){let u=`{"type":"use_packet","json":"{\\"packet_id\\":916403,\\"token\\":\\"${$}\\"}"}`;c[5]=JSON.stringify((await C.get(`https://shop.09game.com/shop?${u}`)).data)}const P=(await C.get(`https://users.09game.com/Home/GetUserInfoV1?token=${$}`)).data;r.created_at=P.temp.created_at.replace("T",""),r.email=P.temp.email,r.phone=P.temp.moile,r.real_name=P.temp.real_name;const S=(await C.get(`https://users.09game.com/Home/GetAllUser?type=0&userInfo=&token=${$}`)).data;r.users=r.users||{};for(let u=0;u<S.msg.length;u++){const v=S.msg[u],j=v.user_id;if(r.users[j]=r.users[j]||{},r.users[j].flag=v.user_flag,r.users[j].user_name=v.user_name,r.users[j].achieve=v.total_score,r.users[j].vip1=v.vip_level,r.users[j].vip2=v.vip2_level,v.vip_level>l.v1&&(b.v1=v.vip_level),v.vip2_level>l.v2&&(b.v2=v.vip2_level),j!=h&&X(v.user_flag)){await C.get(`https://users.09game.com/Home/SetDefaultLogin?token=${$}&user_id=${j}`),c[0]=`${T.value+1}/${E.value} "${v.user_name}" [${u+1}/${S.msg.length}] æå°± ${v.total_score}`;const A=await y();if(A){if(c[3]=JSON.stringify((await C.get(`https://hd.09game.com/s29diancang/SignIn?token=${A}`)).data),R.value){let ne=`{"type":"use_packet","json":"{\\"packet_id\\":916403,\\"token\\":\\"${A}\\"}"}`;c[5]=JSON.stringify((await C.get(`https://shop.09game.com/shop?${ne}`)).data)}const q={};let M=`{"type":"q_my_item","json":"{\\"token\\":\\"${A}\\"}"}`,z=(await C.get(`https://shop.09game.com/shop?${M}`)).data;if(z.code===0&&z.count>=1){let ne=z.records;for(let ie of ne)q[`id${ie.item_id}`]=Object.fromEntries(Object.entries(ie).filter(([_e])=>!["item_id","func_id","item_type","use_flag"].includes(_e))),ie.item_id===20054&&(b.g=ie.amount)}if(M=`{"type":"q_my_item","json":"{\\"token\\":\\"${A}\\",\\"GAME_TYPE\\":1}"}`,z=(await C.get(`https://shop.09game.com/shop?${M}`)).data,z.code===0&&z.count>=1){let ne=z.records;for(let ie of ne)ie.func_id===7&&(q[`id${ie.item_id}`]=Object.fromEntries(Object.entries(ie).filter(([_e])=>!["item_id","func_id","item_type","use_flag"].includes(_e))))}r.users[j].bag=q,M=`{"type":"q_my_money","json":"{\\"token\\":\\"${A}\\"}"}`;const de=(await C.get(`https://shop.09game.com/shop?${M}`)).data;de.code===0&&de.count===1&&(r.users[j].money1=de.records[0].money1,r.users[j].money2=de.records[0].money2)}}}const w={};let _=`{"type":"q_my_item","json":"{\\"token\\":\\"${$}\\"}"}`,f=(await C.get(`https://shop.09game.com/shop?${_}`)).data;if(f.code===0&&f.count>=1){let u=f.records;for(let v of u)w[`id${v.item_id}`]=Object.fromEntries(Object.entries(v).filter(([j])=>!["item_id","func_id","item_type","use_flag"].includes(j))),v.item_id===20054&&(b.g=v.amount)}if(_=`{"type":"q_my_item","json":"{\\"token\\":\\"${$}\\",\\"GAME_TYPE\\":1}"}`,f=(await C.get(`https://shop.09game.com/shop?${_}`)).data,f.code===0&&f.count>=1){let u=f.records;for(let v of u)v.func_id===7&&(w[`id${v.item_id}`]=Object.fromEntries(Object.entries(v).filter(([j])=>!["item_id","func_id","item_type","use_flag"].includes(j))))}r.users[h].bag=w,_=`{"type":"q_my_money","json":"{\\"token\\":\\"${$}\\"}"}`;const k=(await C.get(`https://shop.09game.com/shop?${_}`)).data;k.code===0&&k.count===1&&(r.users[h].money1=k.records[0].money1,r.users[h].money2=k.records[0].money2)}else r.newpasswords[r.newpassword]+=1,b.token="";b.data=r,await e.collection("sales").update(l.id,b),T.value+=1}catch{await i(1e3)}if(!L.value)break}}async function W(){var I,p;for(await x.run('process.kill("siyou.*");process.kill("Siyou.*");'),E.value=(await e.collection("sales").getList(1,1,{filter:g.value})).totalItems,T.value=0;T.value<E.value;)try{const l=await e.collection("sales").getFirstListItem(g.value,{sort:`${D.value?"-":""}${B.value}`}),r=l.data;c.map((h,P)=>c[P]="");let b="";H.value=(await e.collection("sales").getList(1,1,{filter:`login_time>"${s(1)}"`})).totalItems,c[0]=`æè¿1å°æ¶ç»å½ï¼${H.value}`,c[1]=`${T.value+1}/${E.value} "${l.user_name}" ${l.lv}`,c[2]=`"${l.name}" "${r.newpassword}"`;let y={login_time:s(0)};await x.run(ye.replace(/__a__/,l.name).replace(/__b__/,r.newpassword)),await i(20),await x.run('process("C:/Program Files (x86)/09Platform/bins/siyou_client.exe")'),await i(1e3);let $=await x.run('var prcs=process.find("siyou_client.exe");return prcs?prcs.id:null');c[3]=`pid: ${$}`,await x.run(`mouse.click(${o.value}, true)`);for(let h=0;h<10;h++)await i(100),await x.run(`mouse.click(${o.value}, true)`);c[4]="0 token:";for(let h=0;h<m.value;h++){await i(100),[1,5,10,20].includes(h)&&(await x.run(`win.setForeground(winex.find(,,${$}))`),await x.run(`mouse.click(${o.value}, true)`));let P="";try{P=await x.run('return http.get(string.format("http://127.0.0.1:2009/json?time=%d", tonumber(time())))||null')}catch{}if(b=P&&((p=(I=JSON.parse(P).find(S=>(S.url.match(/token=([^&]+)/)||[])[1]))==null?void 0:I.url.match(/token=([^&]+)/))==null?void 0:p[1])||null,c[4]=`${h} token: ${b}`,b)break}try{await x.run('process.kill("siyou_client.exe");process.kill("siyouWebview.exe");')}catch(h){console.log(h)}if(b){y.token=b,y.token_time=s(0),r.newpasswords[r.newpassword]=0,c[2]=`[${Object.keys(r.users).length}]`;let h=(await C.get(`https://users.09game.com/Home/GetUserInfoV1?token=${b}`)).data;r.created_at=h.temp.created_at.replace("T",""),r.email=h.temp.email,r.phone=h.temp.moile,r.real_name=h.temp.real_name,h.temp.Id_card===1&&(r.id_card_number=h.temp.id_card_number),h=(await C.get(`https://users.09game.com/Home/GetAllUser?type=0&userInfo=&token=${b}`)).data,r.users={};for(let w=0;w<h.msg.length;w++){const _=h.msg[w],f=_.user_id;if(r.users[f]=r.users[f]||{},r.users[f].flag=_.user_flag,r.users[f].user_name=_.user_name,r.users[f].achieve=_.total_score,r.users[f].vip1=_.vip_level,r.users[f].vip2=_.vip2_level,f==b.split("-")[0]){y.v1=_.vip_level,y.v2=_.vip2_level;const k={};let u=`{"type":"q_my_item","json":"{\\"token\\":\\"${b}\\"}"}`,v=(await C.get(`https://shop.09game.com/shop?${u}`)).data;if(v.code===0&&v.count>=1){let A=v.records;for(let q of A)k[`id${q.item_id}`]=Object.fromEntries(Object.entries(q).filter(([M])=>!["item_id","func_id","item_type","use_flag"].includes(M))),q.item_id===20054&&(y.g=q.amount)}r.users[f].bag=k,u=`{"type":"q_my_money","json":"{\\"token\\":\\"${b}\\"}"}`;let j=`https://shop.09game.com/shop?${u}`;v=(await C.get(j)).data,v.code===0&&v.count===1&&(r.users[f].money1=v.records[0].money1,r.users[f].money2=v.records[0].money2)}}if(Object.keys(r.users).length<4){let w=U(l.user_name);w=U(l.user_name),w=w.replace(/[a-zA-Z]/g,"").replace("å¾","å").replace("æ¹","å£").replace("åªåª","é"),w.length==1&&(w=w+se(1)),w=U(w);let _=(await C.get(`https://users.09game.com/Home/GetNameExist?user_name=${w}`)).data;_.code!=0&&(w="é¾"+l.user_name[0]+U(l.user_name[0]+l.user_name[l.user_name.length-1])+"ç",w=U(w),w=U(w),w=U(w),w=U(w)),_=(await C.get(`https://users.09game.com/Home/SetUserName?token=${b}&user_name=${w}`)).data,c[2]+=`${w}${JSON.stringify(_)} `}h=(await C.get(`https://hd.09game.com/s28diancang/SignIn?token=${b}`)).data,c[5]=JSON.stringify(h);let S=`https://shop.09game.com/shop?${`{"type":"use_packet","json":"{\\"packet_id\\":916401,\\"token\\":\\"${b}\\"}"}`}`;h=(await C.get(S)).data,c[6]=JSON.stringify(h),h=(await C.get(`https://users.09game.com/Home/GetUserInfoV1?token=${b}`)).data,r.created_at=h.temp.created_at.replace("T",""),r.email=h.temp.email,r.phone=h.temp.moile,r.real_name=h.temp.real_name,h.temp.Id_card===1&&(r.id_card_number=h.temp.id_card_number),h=(await C.get(`https://users.09game.com/Home/GetAllUser?type=0&userInfo=&token=${b}`)).data,r.users=r.users||{};for(let w=0;w<h.msg.length;w++){const _=h.msg[w],f=_.user_id;if(r.users[f]=r.users[f]||{},r.users[f].flag=_.user_flag,r.users[f].user_name=_.user_name,r.users[f].achieve=_.total_score,r.users[f].vip1=_.vip_level,r.users[f].vip2=_.vip2_level,f==b.split("-")[0]){y.v1=_.vip_level,y.v2=_.vip2_level;const k={};let u=`{"type":"q_my_item","json":"{\\"token\\":\\"${b}\\"}"}`,v=(await C.get(`https://shop.09game.com/shop?${u}`)).data;if(v.code===0&&v.count>=1){let A=v.records;for(let q of A)k[`id${q.item_id}`]=Object.fromEntries(Object.entries(q).filter(([M])=>!["item_id","func_id","item_type","use_flag"].includes(M))),q.item_id===20054&&(y.g=q.amount)}r.users[f].bag=k,u=`{"type":"q_my_money","json":"{\\"token\\":\\"${b}\\"}"}`;let j=`https://shop.09game.com/shop?${u}`;v=(await C.get(j)).data,v.code===0&&v.count===1&&(r.users[f].money1=v.records[0].money1,r.users[f].money2=v.records[0].money2)}}}else r.newpasswords[r.newpassword]+=1;if(y.data=r,await e.collection("sales").update(l.id,y),!L.value)break;T.value+=1}catch{}}function se(I){function p(r,b){return Math.floor(Math.random()*(r-b)+b)}let l="";for(let r=0;r<I;r++)l+=String.fromCharCode(p(19968,40869));return l}function U(I){const p=Math.floor(Math.random()*I.length);I[p];const l="é£é¨äºé·ç«å°åæ³åæªç®­ç¾ç²åµé­å¿åéå½±ç¿¼åæé·çµç³æ°´é£èé³éªéçªçè§éèå®å¾çç ´ææ¶æ³¢æµªé£çç°è±è¶ç¿é¸è·è¡å²å»ç¾æ¤å¾¡ç¿»è¦è£ææ©å¬ç­ç»ææ­»å½ç¥é¬¼çå¸å£å°å®å¸ä¾¯å°å¸å£«ä¾ç¥æ®¿å å®å«æ¤å»è´¤èå¸å¾å®å¼å­ä½¿èæé¨å®æ¤å¾¡å¸è",r=l[Math.floor(Math.random()*l.length)];return I.slice(0,p)+r+I.slice(p+1)}return(I,p)=>(Se(),Te(K(dt),null,{default:te(()=>[G(K(ot),null,{default:te(()=>[G(K(ge),{value:g.value,"onUpdate:value":p[0]||(p[0]=l=>g.value=l),type:"text",placeholder:"filter",style:{"margin-bottom":"10px"}},null,8,["value"]),G(K(nt),{"item-style":"display: flex;",align:"center"},{default:te(()=>[G(K(ge),{value:B.value,"onUpdate:value":p[1]||(p[1]=l=>B.value=l),type:"text",placeholder:"sort",style:{width:"110px"}},null,8,["value"]),G(K(ge),{value:o.value,"onUpdate:value":p[2]||(p[2]=l=>o.value=l),type:"text",placeholder:"åæ ",style:{width:"80px"}},null,8,["value"]),G(K(ge),{value:d.value,"onUpdate:value":p[3]||(p[3]=l=>d.value=l),type:"text",placeholder:"å¯ç ",style:{width:"80px"}},null,8,["value"]),G(K(it),{value:m.value,"onUpdate:value":p[4]||(p[4]=l=>m.value=l),placeholder:"å¾ªç¯",style:{width:"80px"}},null,8,["value"]),G(K(Ce),{checked:D.value,"onUpdate:checked":p[5]||(p[5]=l=>D.value=l)},{default:te(()=>[le(" éåº ")]),_:1},8,["checked"]),G(K(Ce),{checked:L.value,"onUpdate:checked":p[6]||(p[6]=l=>L.value=l)},{default:te(()=>[le(" ç»§ç»­ ")]),_:1},8,["checked"]),G(K(Ce),{checked:R.value,"onUpdate:checked":p[7]||(p[7]=l=>R.value=l)},{default:te(()=>[le(" ä½¿ç¨ ")]),_:1},8,["checked"]),G(K(fe),{type:"info",onClick:p[8]||(p[8]=l=>me())},{default:te(()=>[le("Test")]),_:1}),G(K(fe),{type:"info",onClick:p[9]||(p[9]=l=>oe())},{default:te(()=>[le("Sign")]),_:1}),G(K(fe),{type:"info",onClick:p[10]||(p[10]=l=>ee())},{default:te(()=>[le("Sign4")]),_:1}),G(K(fe),{type:"error",onClick:p[11]||(p[11]=l=>oe(!0))},{default:te(()=>[le("Game")]),_:1}),G(K(fe),{type:"success",onClick:p[12]||(p[12]=l=>W())},{default:te(()=>[le("New")]),_:1})]),_:1})]),_:1}),(Se(!0),rt(ct,null,at(c,l=>(Se(),Te(K(wt),null,{default:te(()=>[le(lt(l),1)]),_:2},1024))),256))]),_:1}))}});export{Ut as default};
